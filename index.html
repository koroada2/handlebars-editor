<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô Handlebars ÏóêÎîîÌÑ∞</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.4/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.4/ext-language_tools.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.4/mode-handlebars.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.4/theme-monokai.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.4/theme-twilight.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client"></script>
    <style>
        :root {
            --bg-color: #1e1e1e;
            --header-bg: #646cff;
            --sidebar-bg: #252526;
            --button-bg: #3e3e42;
            --button-hover: #4b4b4f;
            --font-color: #d4d4d4;
            --line-number-color: #858585;
            --active-line-bg: #264f78;
            --border-color: #3e3e42;
            --dropdown-bg: #2d2d2d;
            --dropdown-hover: #3e3e3e;
            --dropdown-border: #505050;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --error-color: #f44336;
            --modal-bg: #2a2a2a;
            --google-blue: #4285f4;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Consolas', 'Monaco', 'Andale Mono', monospace;
        }
        
        body {
            background-color: var(--bg-color);
            color: var(--font-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .top-bar {
            display: flex;
            height: 40px;
            background-color: var(--bg-color);
            border-bottom: 1px solid var(--border-color);
            align-items: center;
            padding: 0 10px;
            z-index: 100;
        }
        
        .hamburger-menu {
            display: inline-flex;
            flex-direction: column;
            justify-content: space-between;
            height: 16px;
            width: 20px;
            cursor: pointer;
            margin-right: 15px;
            position: relative;
        }
        
        .hamburger-menu span {
            display: block;
            height: 2px;
            width: 100%;
            background-color: var(--font-color);
        }
        
        .tab {
            background-color: var(--sidebar-bg);
            color: var(--font-color);
            padding: 0 15px;
            height: 40px;
            display: flex;
            align-items: center;
            border-right: 1px solid var(--border-color);
        }
        
        .action-button {
            padding: 8px 10px;
            background-color: var(--button-bg);
            color: var(--font-color);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
            font-size: 12px;
            display: flex;
            align-items: center;
        }
        
        .action-button:hover {
            background-color: var(--button-hover);
        }
        
        .action-button.primary {
            background-color: var(--header-bg);
            color: white;
        }
        
        .action-button.primary:hover {
            opacity: 0.9;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            margin-left: auto;
            padding-right: 10px;
        }
        
        .user-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .user-name {
            font-size: 14px;
            max-width: 150px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .google-sign-in {
            background-color: white;
            color: #444;
            display: flex;
            align-items: center;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
            margin-left: auto;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .google-sign-in:hover {
            background-color: #f5f5f5;
        }
        
        .google-icon {
            width: 18px;
            height: 18px;
            margin-right: 8px;
        }
        
        .actions {
            margin-left: auto;
            display: flex;
            gap: 5px;
        }
        
        .icon-button {
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border-radius: 3px;
        }
        
        .icon-button:hover {
            background-color: var(--button-hover);
        }
        
        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .sidebar {
            width: 40px;
            background-color: var(--sidebar-bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 10px;
            border-right: 1px solid var(--border-color);
            z-index: 50;
        }
        
        .sidebar-icon {
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
            cursor: pointer;
            border-left: 2px solid transparent;
        }
        
        .sidebar-icon:hover, .sidebar-icon.active {
            border-left: 2px solid var(--header-bg);
        }
        
        .sidebar-icon svg {
            width: 18px;
            height: 18px;
            fill: var(--font-color);
        }
        
        .editor-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .editor-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-color);
            overflow: hidden;
        }
        
        .tab-bar {
            display: flex;
            height: 40px;
            background-color: var(--sidebar-bg);
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
        }
        
        .editor-tab {
            padding: 0 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            border-right: 1px solid var(--border-color);
            min-width: 120px;
            max-width: 180px;
            height: 40px;
            position: relative;
            user-select: none;
        }
        
        .editor-tab.active {
            background-color: var(--bg-color);
        }
        
        .editor-tab .close-tab {
            margin-left: 10px;
            opacity: 0.6;
            font-size: 16px;
        }
        
        .editor-tab .close-tab:hover {
            opacity: 1;
        }
        
        .editor-tab .tab-title {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .create-tab {
            width: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .editor-wrapper {
            display: flex;
            flex: 1;
            overflow: hidden;
            position: relative;
        }
        
        .code-editor {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            font-size: 14px;
        }
        
        .preview-panel {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            overflow: auto;
            padding: 10px;
            font-family: Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--font-color);
        }
        
        /* Í≤ÄÏÉâ Ìå®ÎÑê */
        .search-panel {
            position: absolute;
            top: 0;
            right: 10px;
            background-color: var(--dropdown-bg);
            border: 1px solid var(--dropdown-border);
            border-radius: 4px;
            padding: 10px;
            display: none;
            z-index: 10;
            flex-direction: column;
            gap: 8px;
            min-width: 300px;
        }
        
        .search-panel.active {
            display: flex;
        }
        
        .search-input-group {
            display: flex;
            gap: 5px;
        }
        
        .search-input-group input {
            flex: 1;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            padding: 5px;
            color: var(--font-color);
            border-radius: 3px;
        }
        
        .search-actions {
            display: flex;
            gap: 5px;
            justify-content: space-between;
        }
        
        .search-actions button {
            background-color: var(--button-bg);
            border: none;
            color: var(--font-color);
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 3px;
        }
        
        .search-actions button:hover {
            background-color: var(--button-hover);
        }
        
        .search-options {
            display: flex;
            gap: 10px;
        }
        
        .search-option {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
        }
        
        /* ÏÑ§Ï†ï Î©îÎâ¥ */
        .settings-menu {
            position: absolute;
            top: 40px;
            left: 40px;
            width: 250px;
            background-color: var(--dropdown-bg);
            border: 1px solid var(--dropdown-border);
            border-radius: 4px;
            padding: 10px;
            z-index: 100;
            display: none;
        }
        
        .settings-menu.active {
            display: block;
        }
        
        .settings-menu h3 {
            margin-bottom: 10px;
            font-size: 14px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 5px;
        }
        
        .settings-group {
            margin-bottom: 15px;
        }
        
        .settings-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 12px;
        }
        
        .settings-group select, .settings-group input {
            width: 100%;
            padding: 5px;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--font-color);
            border-radius: 3px;
        }
        
        /* ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§ ÏïàÎÇ¥ */
        .keyboard-shortcuts {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--modal-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 20px;
            z-index: 200;
            width: 500px;
            max-width: 90%;
            max-height: 80%;
            overflow: auto;
            display: none;
        }
        
        .keyboard-shortcuts.active {
            display: block;
        }
        
        .keyboard-shortcuts h2 {
            margin-bottom: 15px;
            font-size: 16px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }
        
        .shortcut-group {
            margin-bottom: 15px;
        }
        
        .shortcut-group h3 {
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .shortcut-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 13px;
        }
        
        .key {
            background-color: var(--button-bg);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
        
        .close-modal {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            font-size: 18px;
            color: var(--font-color);
        }
        
        /* Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÌååÏùº Î™©Î°ù */
        .drive-modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--modal-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 20px;
            z-index: 200;
            width: 600px;
            max-width: 90%;
            max-height: 80%;
            display: none;
            flex-direction: column;
        }
        
        .drive-modal.active {
            display: flex;
        }
        
        .drive-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .drive-modal-header h2 {
            font-size: 16px;
        }
        
        .drive-filter {
            display: flex;
            margin-bottom: 15px;
        }
        
        .drive-filter input {
            flex: 1;
            padding: 8px;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--font-color);
            border-radius: 3px;
        }
        
        .drive-files-container {
            flex: 1;
            overflow-y: auto;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            margin-bottom: 15px;
        }
        
        .drive-files-list {
            list-style: none;
        }
        
        .drive-file-item {
            padding: 8px 12px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
        }
        
        .drive-file-item:hover {
            background-color: var(--dropdown-hover);
        }
        
        .drive-file-icon {
            margin-right: 10px;
            width: 16px;
            height: 16px;
        }
        
        .drive-file-name {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .drive-file-date {
            font-size: 12px;
            color: #888;
            margin-left: 10px;
        }
        
        .drive-modal-actions {
            display: flex;
            justify-content: space-between;
        }
        
        .drive-modal-actions .left {
            display: flex;
            gap: 10px;
        }
        
        .drive-modal-actions .right {
            display: flex;
            gap: 10px;
        }
        
        /* ÏÉà ÌååÏùº ÏÉùÏÑ± Î™®Îã¨ */
        .new-file-modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--modal-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 20px;
            z-index: 200;
            width: 400px;
            max-width: 90%;
            display: none;
        }
        
        .new-file-modal.active {
            display: block;
        }
        
        .new-file-modal h2 {
            margin-bottom: 15px;
            font-size: 16px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }
        
        .file-input {
            margin-bottom: 15px;
        }
        
        .file-input label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .file-input input {
            width: 100%;
            padding: 8px;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--font-color);
            border-radius: 3px;
        }
        
        .file-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .file-actions button {
            padding: 8px 15px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .file-actions .cancel {
            background-color: var(--button-bg);
            color: var(--font-color);
        }
        
        .file-actions .create {
            background-color: var(--header-bg);
            color: white;
        }
        
        /* ÏïåÎ¶º */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 15px;
            border-radius: 4px;
            color: white;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .notification.success {
            background-color: var(--success-color);
        }
        
        .notification.warning {
            background-color: var(--warning-color);
        }
        
        .notification.error {
            background-color: var(--error-color);
        }
        
        .notification.active {
            opacity: 1;
        }
        
        /* ÏÉÅÌÉú ÌëúÏãúÏ§Ñ */
        .status-bar {
            height: 25px;
            background-color: var(--sidebar-bg);
            display: flex;
            align-items: center;
            padding: 0 10px;
            border-top: 1px solid var(--border-color);
            font-size: 12px;
        }
        
        .status-item {
            margin-right: 15px;
        }
        
        .status-right {
            margin-left: auto;
            display: flex;
            gap: 15px;
        }
        
        /* Î°úÎî© Ïä§ÌîºÎÑà */
        .spinner {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--header-bg);
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Î°úÎî© Ïò§Î≤ÑÎ†àÏù¥ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            display: none;
        }
        
        .loading-overlay.active {
            display: flex;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--header-bg);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }
        
        .loading-text {
            color: white;
            font-size: 16px;
        }
        
        /* ÎìúÎùºÏù¥Î∏å ÌååÏùº ÎìúÎ°≠Îã§Ïö¥ Î©îÎâ¥ */
        .file-dropdown {
            position: absolute;
            background-color: var(--dropdown-bg);
            border: 1px solid var(--dropdown-border);
            border-radius: 3px;
            min-width: 150px;
            z-index: 300;
            display: none;
        }
        
        .file-dropdown.active {
            display: block;
        }
        
        .dropdown-item {
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .dropdown-item:hover {
            background-color: var(--dropdown-hover);
        }
        
        .dropdown-divider {
            height: 1px;
            background-color: var(--border-color);
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="hamburger-menu" id="menuToggle">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="tab file-name-display">Untitled</div>
        
        <div class="actions">
            <button class="action-button" id="newFileButton">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 5px;">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="12" y1="18" x2="12" y2="12"></line>
                    <line x1="9" y1="15" x2="15" y2="15"></line>
                </svg>
                ÏÉà ÌååÏùº
            </button>
            <button class="action-button" id="openFileButton">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 5px;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                </svg>
                Ïó¥Í∏∞
            </button>
            <button class="action-button primary" id="saveButton">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 5px;">
                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                    <polyline points="17 21 17 13 7 13 7 21"></polyline>
                    <polyline points="7 3 7 8 15 8"></polyline>
                </svg>
                Ï†ÄÏû•
            </button>
            
            <div class="icon-button" id="searchButton" title="Í≤ÄÏÉâ (Ctrl+F)">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
                    <path fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 0 0 1.57-5.73A6.5 6.5 0 1 0 10 14.25a6.5 6.5 0 0 0 5.73-1.57l.27.28v.79l5 4.99L22.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                </svg>
            </div>
            <div class="icon-button" id="settingsButton" title="ÏÑ§Ï†ï">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
                    <path fill="currentColor" d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.38-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.38.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
                </svg>
            </div>
            <div class="icon-button" id="helpButton" title="Îã®Ï∂ïÌÇ§">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
                    <path fill="currentColor" d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/>
                </svg>
            </div>
        </div>
        
        <!-- Íµ¨Í∏Ä Î°úÍ∑∏Ïù∏ Î≤ÑÌäº (Î°úÍ∑∏Ïù∏ Ï†Ñ) -->
        <div class="google-sign-in" id="googleSignIn">
            <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNMTcuNiA5LjJsLS4xLTEuOEg5djMuNGg0LjhDMTMuNiAxMiAxMyAxMyAxMiAxMy42djIuMmgzYTguOCA4LjggMCAwIDAgMi42LTYuNnoiIGZpbGw9IiM0Mjg1RjQiIGZpbGwtcnVsZT0ibm9uemVybyIvPjxwYXRoIGQ9Ik05IDE4YzIuNCAwIDQuNS0uOCA2LTIuMmwtMy0yLjJhNS40IDUuNCAwIDAgMS04LTIuOUgxVjEzYTkgOSAwIDAgMCA4IDV6IiBmaWxsPSIjMzRBODUzIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48cGF0aCBkPSJNNCAxMC43YTUuNCA1LjQgMCAwIDEgMC0zLjRWNUgxYTkgOSAwIDAgMCAwIDhsMy0yLjN6IiBmaWxsPSIjRkJCQzA1IiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48cGF0aCBkPSJNOSAzLjZjMS4zIDAgMi41LjQgMy40IDEuM0wxNSAyLjNBOSA5IDAgMCAwIDEgNWwzIDIuNGE1LjQgNS40IDAgMCAxIDUtMy43eiIgZmlsbD0iI0VBNDMzNSIgZmlsbC1ydWxlPSJub256ZXJvIi8+PHBhdGggZD0iTTAgMGgxOHYxOEgweiIvPjwvZz48L3N2Zz4=" class="google-icon" alt="Google">
            Íµ¨Í∏Ä Î°úÍ∑∏Ïù∏
        </div>
        
        <!-- ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ (Î°úÍ∑∏Ïù∏ ÌõÑ) -->
        <div class="user-info" id="userInfo" style="display: none;">
            <img class="user-avatar" id="userAvatar" src="" alt="User">
            <span class="user-name" id="userName"></span>
            <div class="icon-button" id="userLogout" title="Î°úÍ∑∏ÏïÑÏõÉ">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
            </div>
        </div>
    </div>
    
    <div class="main-content">
        <div class="sidebar">
            <div class="sidebar-icon active" title="ÏóêÎîîÌÑ∞">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/>
                </svg>
            </div>
            <div class="sidebar-icon" id="driveButton" title="Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                </svg>
            </div>
            <div class="sidebar-icon" id="splitViewButton" title="Î∂ÑÌï† Î≥¥Í∏∞">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M3 19h18v-6H3v6zm0-8h18V5H3v6z"/>
                </svg>
            </div>
        </div>

        <div class="editor-container">
            <div class="editor-section" style="flex: 1;">
                <div class="tab-bar">
                    <div class="editor-tab active">
                        <span class="tab-title">main.hbs</span>
                        <span class="close-tab">√ó</span>
                    </div>
                </div>
                <div class="editor-wrapper">
                    <div id="editor" class="code-editor"></div>
                    <!-- Í≤ÄÏÉâ Ìå®ÎÑê -->
                    <div class="search-panel">
                        <div class="search-input-group">
                            <input type="text" id="searchInput" placeholder="Í≤ÄÏÉâÏñ¥">
                            <input type="text" id="replaceInput" placeholder="Î∞îÍøÄ ÌÖçÏä§Ìä∏">
                        </div>
                        <div class="search-actions">
                            <div class="search-options">
                                <div class="search-option">
                                    <input type="checkbox" id="caseSensitive">
                                    <label for="caseSensitive">ÎåÄÏÜåÎ¨∏Ïûê Íµ¨Î∂Ñ</label>
                                </div>
                                <div class="search-option">
                                    <input type="checkbox" id="wholeWord">
                                    <label for="wholeWord">Îã®Ïñ¥ Îã®ÏúÑ</label>
                                </div>
                                <div class="search-option">
                                    <input type="checkbox" id="regExp">
                                    <label for="regExp">Ï†ïÍ∑úÏãù</label>
                                </div>
                            </div>
                            <div>
                                <button id="findButton">Ï∞æÍ∏∞</button>
                                <button id="replaceButton">Î∞îÍæ∏Í∏∞</button>
                                <button id="replaceAllButton">Î™®Îëê Î∞îÍæ∏Í∏∞</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="previewSection" class="editor-section" style="display: none; flex: 1;">
                <div class="tab-bar">
                    <div class="editor-tab active">
                        <span class="tab-title">ÎØ∏Î¶¨Î≥¥Í∏∞</span>
                    </div>
                </div>
                <div class="editor-wrapper">
                    <div id="preview" class="preview-panel"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="status-bar">
        <div class="status-item" id="cursor-position">Ï§Ñ: 1, Ïó¥: 1</div>
        <div class="status-item" id="file-type">Handlebars</div>
        <div class="status-right">
            <div class="status-item" id="save-status">Ï†ÄÏû•Îê®</div>
            <div class="status-item" id="encoding">UTF-8</div>
        </div>
    </div>
    
    <!-- ÏÑ§Ï†ï Î©îÎâ¥ -->
    <div class="settings-menu">
        <h3>ÏóêÎîîÌÑ∞ ÏÑ§Ï†ï</h3>
        <div class="settings-group">
            <label for="themeSelect">ÌÖåÎßà</label>
            <select id="themeSelect">
                <option value="monokai">Monokai</option>
                <option value="twilight">Twilight</option>
                <option value="dracula">Dracula</option>
                <option value="tomorrow_night">Tomorrow Night</option>
            </select>
        </div>
        <div class="settings-group">
            <label for="fontSizeSelect">Í∏ÄÍº¥ ÌÅ¨Í∏∞</label>
            <select id="fontSizeSelect">
                <option value="12">12px</option>
                <option value="14" selected>14px</option>
                <option value="16">16px</option>
                <option value="18">18px</option>
                <option value="20">20px</option>
            </select>
        </div>
        <div class="settings-group">
            <label for="tabSizeSelect">ÌÉ≠ ÌÅ¨Í∏∞</label>
            <select id="tabSizeSelect">
                <option value="2" selected>2</option>
                <option value="4">4</option>
                <option value="8">8</option>
            </select>
        </div>
        <div class="settings-group">
            <label for="wordWrap">ÏûêÎèô Ï§ÑÎ∞îÍøà</label>
            <div class="toggle-switch">
                <input type="checkbox" id="wordWrap" checked>
                <span class="toggle-slider"></span>
            </div>
        </div>
        <div class="settings-group">
            <label for="autoSave">ÏûêÎèô Ï†ÄÏû•</label>
            <div class="toggle-switch">
                <input type="checkbox" id="autoSave" checked>
                <span class="toggle-slider"></span>
            </div>
        </div>
    </div>
    
    <!-- Îã®Ï∂ïÌÇ§ ÎèÑÏõÄÎßê -->
    <div class="keyboard-shortcuts">
        <span class="close-modal">&times;</span>
        <h2>ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§</h2>
        
        <div class="shortcut-group">
            <h3>ÏóêÎîîÌÑ∞</h3>
            <div class="shortcut-item">
                <span>Ï†ÄÏû•</span>
                <span><span class="key">Ctrl</span> + <span class="key">S</span></span>
            </div>
            <div class="shortcut-item">
                <span>Ïã§Ìñâ Ï∑®ÏÜå</span>
                <span><span class="key">Ctrl</span> + <span class="key">Z</span></span>
            </div>
            <div class="shortcut-item">
                <span>Îã§Ïãú Ïã§Ìñâ</span>
                <span><span class="key">Ctrl</span> + <span class="key">Shift</span> + <span class="key">Z</span></span>
            </div>
            <div class="shortcut-item">
                <span>Î≥µÏÇ¨</span>
                <span><span class="key">Ctrl</span> + <span class="key">C</span></span>
            </div>
            <div class="shortcut-item">
                <span>Î∂ôÏó¨ÎÑ£Í∏∞</span>
                <span><span class="key">Ctrl</span> + <span class="key">V</span></span>
            </div>
            <div class="shortcut-item">
                <span>Î™®Îëê ÏÑ†ÌÉù</span>
                <span><span class="key">Ctrl</span> + <span class="key">A</span></span>
            </div>
        </div>
        
        <div class="shortcut-group">
            <h3>Í≤ÄÏÉâ Î∞è Î∞îÍæ∏Í∏∞</h3>
            <div class="shortcut-item">
                <span>Í≤ÄÏÉâ</span>
                <span><span class="key">Ctrl</span> + <span class="key">F</span></span>
            </div>
            <div class="shortcut-item">
                <span>Î∞îÍæ∏Í∏∞</span>
                <span><span class="key">Ctrl</span> + <span class="key">H</span></span>
            </div>
            <div class="shortcut-item">
                <span>Îã§Ïùå Ï∞æÍ∏∞</span>
                <span><span class="key">F3</span></span>
            </div>
            <div class="shortcut-item">
                <span>Ïù¥Ï†Ñ Ï∞æÍ∏∞</span>
                <span><span class="key">Shift</span> + <span class="key">F3</span></span>
            </div>
        </div>
        
        <div class="shortcut-group">
            <h3>Î∑∞</h3>
            <div class="shortcut-item">
                <span>Î∂ÑÌï† Î∑∞ ÌÜ†Í∏Ä</span>
                <span><span class="key">Ctrl</span> + <span class="key">\\</span></span>
            </div>
            <div class="shortcut-item">
                <span>Ï§å Ïù∏</span>
                <span><span class="key">Ctrl</span> + <span class="key">+</span></span>
            </div>
            <div class="shortcut-item">
                <span>Ï§å ÏïÑÏõÉ</span>
                <span><span class="key">Ctrl</span> + <span class="key">-</span></span>
            </div>
        </div>
        
        <div class="shortcut-group">
            <h3>ÌååÏùº</h3>
            <div class="shortcut-item">
                <span>ÏÉà ÌååÏùº</span>
                <span><span class="key">Ctrl</span> + <span class="key">N</span></span>
            </div>
            <div class="shortcut-item">
                <span>ÌååÏùº Ïó¥Í∏∞</span>
                <span><span class="key">Ctrl</span> + <span class="key">O</span></span>
            </div>
            <div class="shortcut-item">
                <span>Ï†ÄÏû•</span>
                <span><span class="key">Ctrl</span> + <span class="key">S</span></span>
            </div>
        </div>
    </div>
    
    <!-- Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÌååÏùº Î™©Î°ù Î™®Îã¨ -->
    <div class="drive-modal" id="driveModal">
        <div class="drive-modal-header">
            <h2>Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÌååÏùº</h2>
            <span class="close-modal">&times;</span>
        </div>
        
        <div class="drive-filter">
            <input type="text" id="fileFilter" placeholder="ÌååÏùº Ïù¥Î¶Ñ Í≤ÄÏÉâ...">
        </div>
        
        <div class="drive-files-container">
            <ul class="drive-files-list" id="driveFilesList">
                <!-- ÌååÏùº Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê Î°úÎìúÎê©ÎãàÎã§ -->
                <li class="drive-file-item">
                    <span class="drive-file-icon">üìÑ</span>
                    <span class="drive-file-name">Î°úÎî© Ï§ë...</span>
                </li>
            </ul>
        </div>
        
        <div class="drive-modal-actions">
            <div class="left">
                <button class="action-button" id="createNewDriveFile">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 5px;">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="12" y1="18" x2="12" y2="12"></line>
                        <line x1="9" y1="15" x2="15" y2="15"></line>
                    </svg>
                    ÏÉà ÌååÏùº ÎßåÎì§Í∏∞
                </button>
                <button class="action-button" id="refreshDriveFiles">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 5px;">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"></path>
                    </svg>
                    ÏÉàÎ°úÍ≥†Ïπ®
                </button>
            </div>
            <div class="right">
                <button class="action-button" id="closeDriveModal">Îã´Í∏∞</button>
            </div>
        </div>
    </div>
    
    <!-- ÏÉà ÌååÏùº ÏÉùÏÑ± Î™®Îã¨ -->
    <div class="new-file-modal" id="newFileModal">
        <span class="close-modal">&times;</span>
        <h2>ÏÉà ÌååÏùº ÎßåÎì§Í∏∞</h2>
        
        <div class="file-input">
            <label for="newFileName">ÌååÏùº Ïù¥Î¶Ñ</label>
            <input type="text" id="newFileName" placeholder="ÌååÏùº Ïù¥Î¶Ñ ÏûÖÎ†•">
        </div>
        
        <div class="file-actions">
            <button class="cancel" id="cancelNewFile">Ï∑®ÏÜå</button>
            <button class="create" id="confirmNewFile">ÎßåÎì§Í∏∞</button>
        </div>
    </div>
    
    <!-- ÌååÏùº Ïù¥Î¶Ñ Î≥ÄÍ≤Ω Î™®Îã¨ -->
    <div class="new-file-modal" id="renameFileModal">
        <span class="close-modal">&times;</span>
        <h2>ÌååÏùº Ïù¥Î¶Ñ Î≥ÄÍ≤Ω</h2>
        
        <div class="file-input">
            <label for="renameFileName">ÏÉà ÌååÏùº Ïù¥Î¶Ñ</label>
            <input type="text" id="renameFileName" placeholder="ÏÉà ÌååÏùº Ïù¥Î¶Ñ ÏûÖÎ†•">
        </div>
        
        <div class="file-actions">
            <button class="cancel" id="cancelRename">Ï∑®ÏÜå</button>
            <button class="create" id="confirmRename">Î≥ÄÍ≤Ω</button>
        </div>
    </div>
    
    <!-- Î°úÎî© Ïò§Î≤ÑÎ†àÏù¥ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Ï≤òÎ¶¨ Ï§ë...</div>
    </div>
    
    <!-- ÌååÏùº Ïª®ÌÖçÏä§Ìä∏ Î©îÎâ¥ -->
    <div class="file-dropdown" id="fileDropdown">
        <div class="dropdown-item" id="openFileMenu">Ïó¥Í∏∞</div>
        <div class="dropdown-item" id="renameFileMenu">Ïù¥Î¶Ñ Î≥ÄÍ≤Ω</div>
        <div class="dropdown-divider"></div>
        <div class="dropdown-item" id="deleteFileMenu">ÏÇ≠Ï†ú</div>
    </div>
    
    <!-- ÏïåÎ¶º -->
    <div class="notification" id="notification"></div>
    
    <script>
        // Íµ¨Í∏Ä API ÏÑ§Ï†ï - Ïó¨Í∏∞Ïóê Ïã§Ï†ú API ÌÇ§ÏôÄ ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ IDÎ•º ÎÑ£ÏúºÏÑ∏Ïöî
        const API_KEY = '';
        const CLIENT_ID = '';
        const DISCOVERY_DOCS = ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'];
        const SCOPES = 'https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.appdata';
        
        // Ïï± ÏÉÅÌÉú Î≥ÄÏàò
        let isAuthenticated = false;
        let currentUser = null;
        let pickerInited = false;
        let gisInited = false;
        let tokenClient;
        let currentFile = {
            id: null,
            name: "Untitled",
            saved: true
        };
        
        // ÏóêÎîîÌÑ∞ Î≥ÄÏàò
        let editor;
        let autoSaveInterval;
        
        document.addEventListener('DOMContentLoaded', function() {
            // Ace ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî
            editor = ace.edit("editor");
            editor.setTheme("ace/theme/monokai");
            editor.session.setMode("ace/mode/handlebars");
            editor.setOptions({
                enableBasicAutocompletion: true,
                enableSnippets: true,
                enableLiveAutocompletion: true,
                fontSize: "14px",
                tabSize: 2,
                useSoftTabs: true,
                wrap: true,
                showPrintMargin: false
            });
            
            // Ï¥àÍ∏∞ ÏΩîÎìú ÏÑ§Ï†ï
            const initialCode = `{{#if {{getGlobalVar::toggle_response_mode}}=1}}}}

## Response Template
- Each chapter seamlessly continue from the previous chapter.
- AI's response MUST follow the template below:

- {{#if {{? 1=1}}}}
- {{#if {{? {{getGlobalVar::toggle_response_language}}=1}}{{{{getGlobalVar::response_language}}}}
# Response
{{/if}}{{#if {{? {{getGlobalVar::toggle_response_language}}=1}}}}
# ÏùëÎãµ
{{/if}}
{{/if}}

- {{#if {{? 2=2}}}}
- {{#if {{getGlobalVar::toggle_pre}}}}
[Interface/Status Window following the instructions in order]
{{/if}}

- {{#if {{? 3=3}}}}
- {{#if {{getGlobalVar::toggle_help}}}}
- {{#if {{? {{getGlobalVar::toggle_response_language}}=1}}{{{{getGlobalVar::response_language}}}}
#### Input Translation
{{/if}}{{#if {{? {{getGlobalVar::toggle_response_language}}=2}}}}
#### ÏûÖÎ†• Î≤àÏó≠
{{/if}}
{{/if}}`;
            editor.setValue(initialCode, -1);
            
            // Ïª§ÏÑú ÏúÑÏπò ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            editor.selection.on('changeCursor', updateCursorPosition);
            
            function updateCursorPosition() {
                const position = editor.getCursorPosition();
                document.getElementById('cursor-position').textContent = `Ï§Ñ: ${position.row + 1}, Ïó¥: ${position.column + 1}`;
            }
            
            // Î≥ÄÍ≤Ω Í∞êÏßÄ
            editor.session.on('change', function() {
                if (currentFile.saved) {
                    currentFile.saved = false;
                    updateSaveStatus();
                }
                
                // ÎØ∏Î¶¨Î≥¥Í∏∞ ÏóÖÎç∞Ïù¥Ìä∏ (ÎØ∏Î¶¨Î≥¥Í∏∞Í∞Ä Ïó¥Î†§ÏûàÏùÑ ÎïåÎßå)
                if (document.getElementById('previewSection').style.display !== 'none') {
                    updatePreview();
                }
            });
            
            // ÌååÏùº Ïù¥Î¶Ñ Î∞è Ï†ÄÏû• ÏÉÅÌÉú ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
            function updateSaveStatus() {
                const fileNameDisplay = document.querySelector('.file-name-display');
                fileNameDisplay.textContent = currentFile.name + (currentFile.saved ? '' : ' *');
                
                document.getElementById('save-status').textContent = currentFile.saved ? 'Ï†ÄÏû•Îê®' : 'Ï†ÄÏû•ÎêòÏßÄ ÏïäÏùå';
            }
            
            // ÎØ∏Î¶¨Î≥¥Í∏∞ ÏóÖÎç∞Ïù¥Ìä∏
            function updatePreview() {
                const previewElement = document.getElementById('preview');
                const code = editor.getValue();
                previewElement.innerHTML = `<pre>${escapeHtml(code)}</pre>`;
            }
            
            // HTML Ïù¥Ïä§ÏºÄÏù¥ÌîÑ Ìï®Ïàò
            function escapeHtml(text) {
                return text
                    .replace(/&/g, "&amp;")
                    .replace(/</g, "&lt;")
                    .replace(/>/g, "&gt;")
                    .replace(/"/g, "&quot;")
                    .replace(/'/g, "&#039;");
            }
            
            // Í≤ÄÏÉâ Ìå®ÎÑê ÌÜ†Í∏Ä
            document.getElementById('searchButton').addEventListener('click', function() {
                const searchPanel = document.querySelector('.search-panel');
                searchPanel.classList.toggle('active');
                if (searchPanel.classList.contains('active')) {
                    document.getElementById('searchInput').focus();
                }
            });
            
            // ÏÑ§Ï†ï Î©îÎâ¥ ÌÜ†Í∏Ä
            document.getElementById('settingsButton').addEventListener('click', function() {
                document.querySelector('.settings-menu').classList.toggle('active');
            });
            
            // Îã®Ï∂ïÌÇ§ ÎèÑÏõÄÎßê ÌÜ†Í∏Ä
            document.getElementById('helpButton').addEventListener('click', function() {
                document.querySelector('.keyboard-shortcuts').classList.toggle('active');
            });
            
            // Î∂ÑÌï† Î∑∞ ÌÜ†Í∏Ä
            document.getElementById('splitViewButton').addEventListener('click', toggleSplitView);
            
            function toggleSplitView() {
                const previewSection = document.getElementById('previewSection');
                if (previewSection.style.display === 'none') {
                    previewSection.style.display = 'flex';
                    updatePreview();
                } else {
                    previewSection.style.display = 'none';
                }
            }
            
            // ÏÑ§Ï†ï Î≥ÄÍ≤Ω Ïù¥Î≤§Ìä∏
            document.getElementById('themeSelect').addEventListener('change', function() {
                editor.setTheme(`ace/theme/${this.value}`);
            });
            
            document.getElementById('fontSizeSelect').addEventListener('change', function() {
                editor.setOption("fontSize", `${this.value}px`);
            });
            
            document.getElementById('tabSizeSelect').addEventListener('change', function() {
                editor.setOption("tabSize", parseInt(this.value));
            });
            
            document.getElementById('wordWrap').addEventListener('change', function() {
                editor.setOption("wrap", this.checked);
            });
            
            document.getElementById('autoSave').addEventListener('change', function() {
                if (this.checked) {
                    enableAutoSave();
                } else {
                    disableAutoSave();
                }
            });
            
            // ÏûêÎèô Ï†ÄÏû• Í∏∞Îä•
            function enableAutoSave() {
                if (autoSaveInterval) {
                    clearInterval(autoSaveInterval);
                }
                
                autoSaveInterval = setInterval(function() {
                    if (!currentFile.saved && isAuthenticated && currentFile.id) {
                        saveFileToDrive();
                    }
                }, 30000); // 30Ï¥àÎßàÎã§ ÏûêÎèô Ï†ÄÏû•
            }
            
            function disableAutoSave() {
                if (autoSaveInterval) {
                    clearInterval(autoSaveInterval);
                    autoSaveInterval = null;
                }
            }
            
            // Í≤ÄÏÉâ Í∏∞Îä•
            document.getElementById('findButton').addEventListener('click', function() {
                const searchValue = document.getElementById('searchInput').value;
                const options = {
                    backwards: false,
                    wrap: true,
                    caseSensitive: document.getElementById('caseSensitive').checked,
                    wholeWord: document.getElementById('wholeWord').checked,
                    regExp: document.getElementById('regExp').checked
                };
                
                editor.find(searchValue, options);
            });
            
            document.getElementById('replaceButton').addEventListener('click', function() {
                const replaceValue = document.getElementById('replaceInput').value;
                editor.replace(replaceValue);
            });
            
            document.getElementById('replaceAllButton').addEventListener('click', function() {
                const searchValue = document.getElementById('searchInput').value;
                const replaceValue = document.getElementById('replaceInput').value;
                const options = {
                    caseSensitive: document.getElementById('caseSensitive').checked,
                    wholeWord: document.getElementById('wholeWord').checked,
                    regExp: document.getElementById('regExp').checked
                };
                
                editor.replaceAll(replaceValue, options);
            });
            
            // Î™®Îã¨ Îã´Í∏∞ Î≤ÑÌäº
            document.querySelectorAll('.close-modal').forEach(function(button) {
                button.addEventListener('click', function() {
                    this.closest('.keyboard-shortcuts, .drive-modal, .new-file-modal').classList.remove('active');
                });
            });
            
            // ÏÉà ÌååÏùº Î≤ÑÌäº
            document.getElementById('newFileButton').addEventListener('click', function() {
                if (!currentFile.saved) {
                    if (confirm("Î≥ÄÍ≤Ω ÏÇ¨Ìï≠ÏùÑ Ï†ÄÏû•ÌïòÏãúÍ≤†ÏäµÎãàÍπå?")) {
                        saveFileToDrive(function() {
                            resetEditor();
                        });
                    } else {
                        resetEditor();
                    }
                } else {
                    resetEditor();
                }
            });
            
            // ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî
            function resetEditor() {
                editor.setValue('', -1);
                currentFile = {
                    id: null,
                    name: "Untitled",
                    saved: true
                };
                updateSaveStatus();
            }
            
            // ÎìúÎùºÏù¥Î∏å Î™®Îã¨ Ïó¥Í∏∞
            document.getElementById('driveButton').addEventListener('click', function() {
                if (isAuthenticated) {
                    document.getElementById('driveModal').classList.add('active');
                    loadDriveFiles();
                } else {
                    handleAuthClick();
                }
            });
            
            // Ïó¥Í∏∞ Î≤ÑÌäº
            document.getElementById('openFileButton').addEventListener('click', function() {
                if (isAuthenticated) {
                    document.getElementById('driveModal').classList.add('active');
                    loadDriveFiles();
                } else {
                    handleAuthClick();
                }
            });
            
            // Ï†ÄÏû• Î≤ÑÌäº
            document.getElementById('saveButton').addEventListener('click', function() {
                if (!isAuthenticated) {
                    handleAuthClick();
                    return;
                }
                
                if (currentFile.id) {
                    saveFileToDrive();
                } else {
                    document.getElementById('newFileModal').classList.add('active');
                    document.getElementById('newFileName').focus();
                }
            });
            
            // ÏÉà ÌååÏùº ÏÉùÏÑ± ÌôïÏù∏
            document.getElementById('confirmNewFile').addEventListener('click', function() {
                const fileName = document.getElementById('newFileName').value.trim() || "Untitled";
                createNewFile(fileName);
                document.getElementById('newFileModal').classList.remove('active');
            });
            
            // ÏÉà ÌååÏùº ÏÉùÏÑ± Ï∑®ÏÜå
            document.getElementById('cancelNewFile').addEventListener('click', function() {
                document.getElementById('newFileModal').classList.remove('active');
            });
            
            // ÌååÏùº Ïù¥Î¶Ñ Î≥ÄÍ≤Ω ÌôïÏù∏
            document.getElementById('confirmRename').addEventListener('click', function() {
                const newFileName = document.getElementById('renameFileName').value.trim();
                if (newFileName) {
                    renameFile(currentFile.id, newFileName);
                    document.getElementById('renameFileModal').classList.remove('active');
                }
            });
            
            // ÌååÏùº Ïù¥Î¶Ñ Î≥ÄÍ≤Ω Ï∑®ÏÜå
            document.getElementById('cancelRename').addEventListener('click', function() {
                document.getElementById('renameFileModal').classList.remove('active');
            });
            
            // ÎìúÎùºÏù¥Î∏åÏóê ÏÉà ÌååÏùº ÏÉùÏÑ±
            document.getElementById('createNewDriveFile').addEventListener('click', function() {
                document.getElementById('newFileModal').classList.add('active');
                document.getElementById('newFileName').focus();
            });
            
            // ÎìúÎùºÏù¥Î∏å ÌååÏùº ÏÉàÎ°úÍ≥†Ïπ®
            document.getElementById('refreshDriveFiles').addEventListener('click', loadDriveFiles);
            
            // ÎìúÎùºÏù¥Î∏å Î™®Îã¨ Îã´Í∏∞
            document.getElementById('closeDriveModal').addEventListener('click', function() {
                document.getElementById('driveModal').classList.remove('active');
            });
            
            // ÌååÏùº ÌïÑÌÑ∞ÎßÅ
            document.getElementById('fileFilter').addEventListener('input', function() {
                const filterText = this.value.toLowerCase();
                const fileItems = document.querySelectorAll('.drive-file-item');
                
                fileItems.forEach(function(item) {
                    const fileName = item.querySelector('.drive-file-name').textContent.toLowerCase();
                    if (fileName.includes(filterText)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
            
            // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§
            document.addEventListener('keydown', function(e) {
                // Ctrl+S: Ï†ÄÏû•
                if (e.ctrlKey && e.key === 's') {
                    e.preventDefault();
                    if (isAuthenticated) {
                        if (currentFile.id) {
                            saveFileToDrive();
                        } else {
                            document.getElementById('newFileModal').classList.add('active');
                            document.getElementById('newFileName').focus();
                        }
                    } else {
                        handleAuthClick();
                    }
                }
                
                // Ctrl+O: ÌååÏùº Ïó¥Í∏∞
                if (e.ctrlKey && e.key === 'o') {
                    e.preventDefault();
                    if (isAuthenticated) {
                        document.getElementById('driveModal').classList.add('active');
                        loadDriveFiles();
                    } else {
                        handleAuthClick();
                    }
                }
                
                // Ctrl+N: ÏÉà ÌååÏùº
                if (e.ctrlKey && e.key === 'n') {
                    e.preventDefault();
                    document.getElementById('newFileButton').click();
                }
                
                // Ctrl+F: Í≤ÄÏÉâ
                if (e.ctrlKey && e.key === 'f') {
                    e.preventDefault();
                    const searchPanel = document.querySelector('.search-panel');
                    searchPanel.classList.add('active');
                    document.getElementById('searchInput').focus();
                }
                
                // Ctrl+\: Î∂ÑÌï† Î∑∞ ÌÜ†Í∏Ä
                if (e.ctrlKey && e.key === '\\') {
                    e.preventDefault();
                    toggleSplitView();
                }
                
                // ESC: Î™®Îã¨, Ìå®ÎÑê Îã´Í∏∞
                if (e.key === 'Escape') {
                    document.querySelector('.search-panel').classList.remove('active');
                    document.querySelector('.settings-menu').classList.remove('active');
                    document.querySelector('.keyboard-shortcuts').classList.remove('active');
                    document.querySelector('.drive-modal').classList.remove('active');
                    document.querySelector('.new-file-modal').classList.remove('active');
                    document.getElementById('renameFileModal').classList.remove('active');
                    document.getElementById('fileDropdown').classList.remove('active');
                }
            });
            
            // Î©îÎâ¥ ÌÜ†Í∏Ä
            document.getElementById('menuToggle').addEventListener('click', function() {
                document.querySelector('.settings-menu').classList.toggle('active');
            });
            
            // ÏïåÎ¶º ÌëúÏãú
            function showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type} active`;
                
                setTimeout(function() {
                    notification.classList.remove('active');
                }, 3000);
            }
            
            // Î°úÎî© ÌëúÏãú
            function showLoading(message = 'Ï≤òÎ¶¨ Ï§ë...') {
                const overlay = document.getElementById('loadingOverlay');
                overlay.querySelector('.loading-text').textContent = message;
                overlay.classList.add('active');
            }
            
            function hideLoading() {
                document.getElementById('loadingOverlay').classList.remove('active');
            }
            
            // Ï¥àÍ∏∞ Ïª§ÏÑú ÏúÑÏπò ÏóÖÎç∞Ïù¥Ìä∏
            updateCursorPosition();
            
            // Íµ¨Í∏Ä API Ï¥àÍ∏∞Ìôî
            function gapiInit() {
                gapi.load('client', initGapiClient);
            }
            
            // Íµ¨Í∏Ä API ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ï¥àÍ∏∞Ìôî
            async function initGapiClient() {
                await gapi.client.init({
                    apiKey: API_KEY,
                    discoveryDocs: DISCOVERY_DOCS,
                });
                
                // GIS Ï¥àÍ∏∞Ìôî
                initGoogleIdentity();
            }
            
            // Google Identity Services Ï¥àÍ∏∞Ìôî
            function initGoogleIdentity() {
                tokenClient = google.accounts.oauth2.initTokenClient({
                    client_id: CLIENT_ID,
                    scope: SCOPES,
                    callback: (tokenResponse) => {
                        if (tokenResponse && !tokenResponse.error) {
                            isAuthenticated = true;
                            getUserInfo();
                            showNotification('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóê Ïó∞Í≤∞ÎêòÏóàÏäµÎãàÎã§.', 'success');
                            enableAutoSave();
                        }
                    }
                });
                
                gisInited = true;
                document.getElementById('googleSignIn').addEventListener('click', handleAuthClick);
                document.getElementById('userLogout').addEventListener('click', handleSignoutClick);
            }
            
            // Ïù∏Ï¶ù Ï≤òÎ¶¨
            function handleAuthClick() {
                if (!gisInited) {
                    showNotification('Íµ¨Í∏Ä APIÎ•º Ï¥àÍ∏∞Ìôî Ï§ëÏûÖÎãàÎã§. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.', 'warning');
                    return;
                }
                
                tokenClient.requestAccessToken({ prompt: 'consent' });
            }
            
            // Î°úÍ∑∏ÏïÑÏõÉ Ï≤òÎ¶¨
            function handleSignoutClick() {
                const token = gapi.client.getToken();
                if (token !== null) {
                    google.accounts.oauth2.revoke(token.access_token);
                    gapi.client.setToken('');
                    isAuthenticated = false;
                    currentUser = null;
                    document.getElementById('userInfo').style.display = 'none';
                    document.getElementById('googleSignIn').style.display = 'flex';
                    disableAutoSave();
                    showNotification('Î°úÍ∑∏ÏïÑÏõÉÎêòÏóàÏäµÎãàÎã§.', 'success');
                }
            }
            
            // ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
            function getUserInfo() {
                const xhr = new XMLHttpRequest();
                xhr.open('GET', 'https://www.googleapis.com/oauth2/v3/userinfo');
                xhr.setRequestHeader('Authorization', 'Bearer ' + gapi.client.getToken().access_token);
                xhr.onload = function() {
                    if (xhr.status === 200) {
                        currentUser = JSON.parse(xhr.responseText);
                        document.getElementById('userAvatar').src = currentUser.picture;
                        document.getElementById('userName').textContent = currentUser.name;
                        document.getElementById('userInfo').style.display = 'flex';
                        document.getElementById('googleSignIn').style.display = 'none';
                    }
                };
                xhr.send();
            }
            
            // ÎìúÎùºÏù¥Î∏å ÌååÏùº Î°úÎìú
            function loadDriveFiles() {
                if (!isAuthenticated) {
                    showNotification('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.', 'warning');
                    return;
                }
                
                showLoading('ÌååÏùº Î™©Î°ù Î°úÎìú Ï§ë...');
                
                gapi.client.drive.files.list({
                    q: "mimeType='text/plain' or mimeType='application/x-handlebars' or name contains '.hbs' or name contains '.handlebars'",
                    fields: 'files(id, name, mimeType, modifiedTime, iconLink)',
                    spaces: 'drive',
                    pageSize: 100
                }).then(function(response) {
                    const files = response.result.files;
                    const filesList = document.getElementById('driveFilesList');
                    filesList.innerHTML = '';
                    
                    if (files && files.length > 0) {
                        files.sort((a, b) => new Date(b.modifiedTime) - new Date(a.modifiedTime));
                        
                        files.forEach(function(file) {
                            const listItem = document.createElement('li');
                            listItem.className = 'drive-file-item';
                            listItem.setAttribute('data-file-id', file.id);
                            
                            const icon = document.createElement('span');
                            icon.className = 'drive-file-icon';
                            icon.textContent = 'üìÑ';
                            
                            const fileName = document.createElement('span');
                            fileName.className = 'drive-file-name';
                            fileName.textContent = file.name;
                            
                            const fileDate = document.createElement('span');
                            fileDate.className = 'drive-file-date';
                            fileDate.textContent = new Date(file.modifiedTime).toLocaleDateString();
                            
                            listItem.appendChild(icon);
                            listItem.appendChild(fileName);
                            listItem.appendChild(fileDate);
                            
                            listItem.addEventListener('click', function() {
                                openFileFromDrive(file.id, file.name);
                            });
                            
                            listItem.addEventListener('contextmenu', function(e) {
                                e.preventDefault();
                                showFileContextMenu(e, file.id, file.name);
                            });
                            
                            filesList.appendChild(listItem);
                        });
                    } else {
                        const emptyMessage = document.createElement('li');
                        emptyMessage.className = 'drive-file-item';
                        emptyMessage.style.justifyContent = 'center';
                        emptyMessage.textContent = 'ÌååÏùºÏù¥ ÏóÜÏäµÎãàÎã§.';
                        filesList.appendChild(emptyMessage);
                    }
                    
                    hideLoading();
                }, function(error) {
                    console.error(error);
                    showNotification('ÌååÏùº Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
                    hideLoading();
                });
            }
            
            // ÎìúÎùºÏù¥Î∏åÏóêÏÑú ÌååÏùº Ïó¥Í∏∞
            function openFileFromDrive(fileId, fileName) {
                showLoading('ÌååÏùº Î∂àÎü¨Ïò§Îäî Ï§ë...');
                
                gapi.client.drive.files.get({
                    fileId: fileId,
                    alt: 'media'
                }).then(function(response) {
                    editor.setValue(response.body, -1);
                    currentFile = {
                        id: fileId,
                        name: fileName,
                        saved: true
                    };
                    updateSaveStatus();
                    hideLoading();
                    document.getElementById('driveModal').classList.remove('active');
                    showNotification(`${fileName} ÌååÏùºÏùÑ Î∂àÎü¨ÏôîÏäµÎãàÎã§.`, 'success');
                }, function(error) {
                    console.error(error);
                    hideLoading();
                    showNotification('ÌååÏùºÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
                });
            }
            
            // ÎìúÎùºÏù¥Î∏åÏóê ÌååÏùº Ï†ÄÏû•
            function saveFileToDrive(callback) {
                if (!isAuthenticated) {
                    showNotification('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.', 'warning');
                    return;
                }
                
                showLoading('ÌååÏùº Ï†ÄÏû• Ï§ë...');
                
                const content = editor.getValue();
                const metadata = {
                    name: currentFile.name,
                    mimeType: 'application/x-handlebars'
                };
                
                if (currentFile.id) {
                    // Í∏∞Ï°¥ ÌååÏùº ÏóÖÎç∞Ïù¥Ìä∏
                    const requestBody = content;
                    const request = gapi.client.request({
                        path: '/upload/drive/v3/files/' + currentFile.id,
                        method: 'PATCH',
                        params: { uploadType: 'media' },
                        body: requestBody
                    });
                    
                    request.execute(function(response) {
                        currentFile.saved = true;
                        updateSaveStatus();
                        hideLoading();
                        showNotification(`${currentFile.name} ÌååÏùºÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.`, 'success');
                        
                        if (callback) callback();
                    });
                } else {
                    // ÏÉà ÌååÏùº ÏÉùÏÑ±
                    const boundary = '-------314159265358979323846';
                    const delimiter = "\r\n--" + boundary + "\r\n";
                    const close_delim = "\r\n--" + boundary + "--";
                    
                    const contentType = 'application/x-handlebars';
                    
                    const multipartRequestBody =
                        delimiter +
                        'Content-Type: application/json\r\n\r\n' +
                        JSON.stringify(metadata) +
                        delimiter +
                        'Content-Type: ' + contentType + '\r\n\r\n' +
                        content +
                        close_delim;
                    
                    const request = gapi.client.request({
                        path: '/upload/drive/v3/files',
                        method: 'POST',
                        params: { uploadType: 'multipart' },
                        headers: {
                            'Content-Type': 'multipart/related; boundary="' + boundary + '"'
                        },
                        body: multipartRequestBody
                    });
                    
                    request.execute(function(response) {
                        if (response.id) {
                            currentFile.id = response.id;
                            currentFile.saved = true;
                            updateSaveStatus();
                            hideLoading();
                            showNotification(`${currentFile.name} ÌååÏùºÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.`, 'success');
                            
                            if (callback) callback();
                        }
                    });
                }
            }
            
            // ÏÉà ÌååÏùº ÏÉùÏÑ±
            function createNewFile(fileName) {
                if (!isAuthenticated) {
                    showNotification('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.', 'warning');
                    return;
                }
                
                // ÌååÏùº ÌôïÏû•Ïûê ÌôïÏù∏ Î∞è Ï∂îÍ∞Ä
                if (!fileName.endsWith('.hbs') && !fileName.endsWith('.handlebars')) {
                    fileName += '.hbs';
                }
                
                currentFile.name = fileName;
                currentFile.id = null;
                currentFile.saved = false;
                updateSaveStatus();
                
                // ÌååÏùº Ï†ÄÏû•
                saveFileToDrive();
            }
            
            // ÌååÏùº Ïù¥Î¶Ñ Î≥ÄÍ≤Ω
            function renameFile(fileId, newFileName) {
                if (!isAuthenticated || !fileId) {
                    showNotification('ÌååÏùºÏùÑ Î≥ÄÍ≤ΩÌï† Ïàò ÏóÜÏäµÎãàÎã§.', 'warning');
                    return;
                }
                
                // ÌååÏùº ÌôïÏû•Ïûê ÌôïÏù∏ Î∞è Ï∂îÍ∞Ä
                if (!newFileName.endsWith('.hbs') && !newFileName.endsWith('.handlebars')) {
                    newFileName += '.hbs';
                }
                
                showLoading('ÌååÏùº Ïù¥Î¶Ñ Î≥ÄÍ≤Ω Ï§ë...');
                
                gapi.client.drive.files.update({
                    fileId: fileId,
                    resource: {
                        name: newFileName
                    }
                }).then(function(response) {
                    currentFile.name = newFileName;
                    updateSaveStatus();
                    hideLoading();
                    showNotification('ÌååÏùº Ïù¥Î¶ÑÏù¥ Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§.', 'success');
                    
                    // ÌååÏùº Î™©Î°ùÏù¥ Ïó¥Î†§ÏûàÏúºÎ©¥ ÏÉàÎ°úÍ≥†Ïπ®
                    if (document.getElementById('driveModal').classList.contains('active')) {
                        loadDriveFiles();
                    }
                }, function(error) {
                    console.error(error);
                    hideLoading();
                    showNotification('ÌååÏùº Ïù¥Î¶Ñ Î≥ÄÍ≤Ω Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
                });
            }
            
            // ÌååÏùº ÏÇ≠Ï†ú
            function deleteFile(fileId, fileName) {
                if (!isAuthenticated || !fileId) {
                    showNotification('ÌååÏùºÏùÑ ÏÇ≠Ï†úÌï† Ïàò ÏóÜÏäµÎãàÎã§.', 'warning');
                    return;
                }
                
                if (!confirm(`"${fileName}" ÌååÏùºÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                    return;
                }
                
                showLoading('ÌååÏùº ÏÇ≠Ï†ú Ï§ë...');
                
                gapi.client.drive.files.delete({
                    fileId: fileId
                }).then(function(response) {
                    // ÌòÑÏû¨ Ïó¥Î¶∞ ÌååÏùºÏù¥ ÏÇ≠Ï†úÎêú Í≤ΩÏö∞
                    if (currentFile.id === fileId) {
                        resetEditor();
                    }
                    
                    hideLoading();
                    showNotification('ÌååÏùºÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.', 'success');
                    
                    // ÌååÏùº Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®
                    loadDriveFiles();
                }, function(error) {
                    console.error(error);
                    hideLoading();
                    showNotification('ÌååÏùº ÏÇ≠Ï†ú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
                });
            }
            
            // ÌååÏùº Ïª®ÌÖçÏä§Ìä∏ Î©îÎâ¥ ÌëúÏãú
            function showFileContextMenu(event, fileId, fileName) {
                const dropdown = document.getElementById('fileDropdown');
                dropdown.style.left = event.pageX + 'px';
                dropdown.style.top = event.pageY + 'px';
                dropdown.classList.add('active');
                
                // ÌååÏùº Ï†ïÎ≥¥ Ï†ÄÏû•
                dropdown.setAttribute('data-file-id', fileId);
                dropdown.setAttribute('data-file-name', fileName);
                
                // Ïù¥Î≤§Ìä∏ Ï≤òÎ¶¨
                document.addEventListener('click', hideFileContextMenu);
            }
            
            // ÌååÏùº Ïª®ÌÖçÏä§Ìä∏ Î©îÎâ¥ Ïà®Í∏∞Í∏∞
            function hideFileContextMenu() {
                document.getElementById('fileDropdown').classList.remove('active');
                document.removeEventListener('click', hideFileContextMenu);
            }
            
            // ÌååÏùº Ïª®ÌÖçÏä§Ìä∏ Î©îÎâ¥ Ïù¥Î≤§Ìä∏
            document.getElementById('openFileMenu').addEventListener('click', function() {
                const dropdown = document.getElementById('fileDropdown');
                const fileId = dropdown.getAttribute('data-file-id');
                const fileName = dropdown.getAttribute('data-file-name');
                
                if (fileId) {
                    openFileFromDrive(fileId, fileName);
                }
            });
            
            document.getElementById('renameFileMenu').addEventListener('click', function() {
                const dropdown = document.getElementById('fileDropdown');
                const fileId = dropdown.getAttribute('data-file-id');
                const fileName = dropdown.getAttribute('data-file-name');
                
                if (fileId) {
                    document.getElementById('renameFileModal').classList.add('active');
                    document.getElementById('renameFileName').value = fileName;
                    document.getElementById('renameFileName').focus();
                    
                    // ÌòÑÏû¨ ÌååÏùºÎ°ú ÏÑ§Ï†ï (Ïù¥Î¶Ñ Î≥ÄÍ≤ΩÏùÑ ÏúÑÌï¥)
                    if (currentFile.id !== fileId) {
                        currentFile.id = fileId;
                        currentFile.name = fileName;
                    }
                }
            });
            
            document.getElementById('deleteFileMenu').addEventListener('click', function() {
                const dropdown = document.getElementById('fileDropdown');
                const fileId = dropdown.getAttribute('data-file-id');
                const fileName = dropdown.getAttribute('data-file-name');
                
                if (fileId) {
                    deleteFile(fileId, fileName);
                }
            });
            
            // Íµ¨Í∏Ä API Î°úÎìú ÏãúÏûë
            try {
                gapiInit();
            } catch (error) {
                console.error('Íµ¨Í∏Ä API Ï¥àÍ∏∞Ìôî Ïò§Î•ò:', error);
                showNotification('Íµ¨Í∏Ä API Ï¥àÍ∏∞Ìôî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
            }
        });
    </script>
</body>
</html>
